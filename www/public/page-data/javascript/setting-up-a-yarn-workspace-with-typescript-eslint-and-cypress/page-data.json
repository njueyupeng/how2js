{"componentChunkName":"component---src-templates-tutorial-tsx","path":"/javascript/setting-up-a-yarn-workspace-with-typescript-eslint-and-cypress","result":{"data":{"post":{"slug":"/javascript/setting-up-a-yarn-workspace-with-typescript-eslint-and-cypress","title":"Setting up a yarn Workspace with TypeScript, ESLint & Cypress","description":"A guide on how to set up a multi-package repository with TypeScript support, linting with ESLint and end-to-end testing with Cypress. Great stack to build front-end packages or Gatsby themes.","excerpt":"If you want to build an npm package there are a myriad of options available to you. One of my favourite ways is to use yarn &  yarnâ€¦","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Setting up a yarn Workspace with TypeScript, ESLint & Cypress\",\n  \"subtitle\": \"A robust solution for multi-package repositories\",\n  \"date\": \"2019-08-05T00:00:00.000Z\",\n  \"lastUpdated\": \"2021-05-08T00:00:00.000Z\",\n  \"description\": \"A guide on how to set up a multi-package repository with TypeScript support, linting with ESLint and end-to-end testing with Cypress. Great stack to build front-end packages or Gatsby themes.\",\n  \"type\": \"tutorial\",\n  \"category\": \"JavaScript\",\n  \"image\": \"/og-images/setting-up-yarn-workspace.png?v=1\",\n  \"published\": true\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar Alert = makeShortcode(\"Alert\");\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"If you want to build an npm package there are a myriad of options available to you. One of my favourite ways is to use yarn & \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://classic.yarnpkg.com/en/docs/workspaces/\"\n  }, \"yarn workspaces\"), \". For smaller or single packages it might be overkill but once you plan on publishing multiple packages a monorepo managed by yarn workspaces can simplify many things. For the purpose of this post I\\u2019m showing an example of using \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.gatsbyjs.com/docs/themes/\"\n  }, \"Gatsby Themes\"), \" with yarn workspaces. This enables the author to quickly test the \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"theme\"), \" inside an \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"example\"), \" site.\"), mdx(\"p\", null, \"At the end of this tutorial you should have a yarn workspace with ESLint linting + Cypress tests + TypeScript for both the example and theme. You can write your theme with TypeScript and have the same ESLint config everywhere.\"), mdx(\"h2\", {\n    \"id\": \"prerequisites\"\n  }, \"Prerequisites\"), mdx(\"p\", null, \"You\\u2019ll need to have yarn installed, if you haven\\u2019t already you can \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://classic.yarnpkg.com/en/docs/install#windows-stable\"\n  }, \"see their installation guide\"), \". Since I\\u2019ll use Gatsby as an example for this guide you can clone \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/gatsbyjs/gatsby-starter-theme-workspace\"\n  }, \"this GitHub starter\"), \". It\\u2019ll spare you some boilerplate to set up, but the fundamental concept for starting a yarn workspace is quite short.\"), mdx(\"p\", null, \"Initialize a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"package.json\"), \" in the root of your site with \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"yarn init\"), \". Once you have a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"package.json\"), \" you can add the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"workspaces\"), \" key:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\",\n    \"metastring\": \"title=package.json\",\n    \"title\": \"package.json\"\n  }, \"{\\n  \\\"name\\\": \\\"gatsby-starter-theme-workspace\\\",\\n  \\\"private\\\": true,\\n  \\\"version\\\": \\\"0.0.1\\\",\\n  \\\"license\\\": \\\"0BSD\\\",\\n  \\\"workspaces\\\": [\\\"gatsby-theme-minimal\\\", \\\"example\\\"]\\n}\\n\")), mdx(\"p\", null, \"In this configuration the folders \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"gatsby-theme-minimal\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"example\"), \" are each a package inside the yarn workspace. If you\\u2019d have multiple packages inside a folder (e.g. \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"folder/package-01\"), \", \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"folder/package-02\"), \" etc.) you can write:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\",\n    \"metastring\": \"title=package.json\",\n    \"title\": \"package.json\"\n  }, \"{\\n  \\\"workspaces\\\": [\\\"folder/*\\\", \\\"another-folder/*\\\"]\\n}\\n\")), mdx(\"p\", null, \"To be able to follow the rest of the guide please clone \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/gatsbyjs/gatsby-starter-theme-workspace\"\n  }, \"the GitHub starter\"), \" so that Gatsby is correctly configured and run \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"yarn\"), \" to install the dependencies.\"), mdx(\"h2\", {\n    \"id\": \"typescript\"\n  }, \"TypeScript\"), mdx(\"p\", null, \"Gatsby itself has TypeScript support and you can write your React components with TypeScript. For linting and type checking to work correctly you\\u2019ll need to install the necessary types. In this small workspace it makes sense to install them at the root, for bigger monorepos you might want to install the types for each package.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"yarn add -D -W @types/node @types/react @types/react-dom\\n\")), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"-D\"), \" flag is for installing them as devDependencies, the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"-W\"), \" flag tells yarn to install them in the workspace root.\"), mdx(\"p\", null, \"To also get type checking you\\u2019ll need to add the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"typescript\"), \" package, a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"tsconfig.json\"), \" and a npm script:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"yarn add -D -W typescript\\n\")), mdx(\"p\", null, \"Add two scripts to the root \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"package.json\"), \":\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\",\n    \"metastring\": \"title=package.json\",\n    \"title\": \"package.json\"\n  }, \"{\\n  \\\"scripts\\\": {\\n    \\\"tsc\\\": \\\"tsc\\\",\\n    \\\"type-check\\\": \\\"tsc --noEmit\\\"\\n  }\\n}\\n\")), mdx(\"p\", null, \"To initialize a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"tsconfig.json\"), \" file you can run \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"yarn tsc --init\"), \". For this guide you can change the values below and leave the rest alone or change it to your liking.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\",\n    \"metastring\": \"title=tsconfig.json\",\n    \"title\": \"tsconfig.json\"\n  }, \"{\\n  \\\"compilerOptions\\\": {\\n    \\\"target\\\": \\\"esnext\\\",\\n    \\\"module\\\": \\\"commonjs\\\",\\n    \\\"jsx\\\": \\\"react\\\",\\n    \\\"lib\\\": [\\\"dom\\\", \\\"es2015\\\", \\\"es2017\\\"],\\n    \\\"moduleResolution\\\": \\\"node\\\",\\n    \\\"strict\\\": true,\\n    \\\"noEmit\\\": true,\\n    \\\"skipLibCheck\\\": true,\\n    \\\"esModuleInterop\\\": true\\n  },\\n  \\\"include\\\": [\\\"./gatsby-theme-minimal/src/**/*\\\"]\\n}\\n\")), mdx(\"h2\", {\n    \"id\": \"eslint\"\n  }, \"ESLint\"), mdx(\"p\", null, \"ESLint in combination with Prettier will both lint and format your code with a specific style guide and checks in place. This way your code stays consistent, some smaller issues/bugs are instantly highlighted and you don\\u2019t need to worry about formatting the code yourself. As the code will be mainly written in TypeScript you\\u2019ll need to set up \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"@typescript-eslint/eslint-plugin\"), \" and its packages. It\\u2019ll also lint & format JavaScript code.\"), mdx(\"p\", null, \"I personally like to use the AirBnB config but feel free to swap it out for your preferred config! The other packages are for accessibility (a11y) checking and checks for React.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"yarn add -D -W @typescript-eslint/eslint-plugin @typescript-eslint/parser eslint eslint-config-airbnb eslint-config-prettier eslint-plugin-import eslint-plugin-jsx-a11y eslint-plugin-prettier eslint-plugin-react eslint-plugin-react-hooks prettier\\n\")), mdx(\"p\", null, \"Add an \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \".eslintrc.js\"), \" file at the root of the project:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\",\n    \"metastring\": \"title=.eslintrc.js\",\n    \"title\": \".eslintrc.js\"\n  }, \"module.exports = {\\n  parser: `@typescript-eslint/parser`,\\n  extends: [`airbnb`, `plugin:prettier/recommended`],\\n  plugins: [`@typescript-eslint`, `prettier`, `react-hooks`],\\n  parserOptions: {\\n    ecmaVersion: 2018,\\n    sourceType: `module`,\\n    ecmaFeatures: {\\n      jsx: true,\\n    },\\n  },\\n  env: {\\n    browser: true,\\n    jest: true,\\n    node: true,\\n  },\\n  globals: {\\n    cy: true,\\n    Cypress: true,\\n  },\\n  rules: {\\n    \\\"@typescript-eslint/no-unused-vars\\\": [\\n      1,\\n      {\\n        argsIgnorePattern: `res|next|stage|^err|on|config|e|_`,\\n      },\\n    ],\\n    \\\"arrow-body-style\\\": [2, `as-needed`],\\n    \\\"no-param-reassign\\\": [\\n      2,\\n      {\\n        props: false,\\n      },\\n    ],\\n    \\\"no-unused-expressions\\\": [\\n      1,\\n      {\\n        allowTaggedTemplates: true,\\n      },\\n    ],\\n    quotes: `off`,\\n    \\\"@typescript-eslint/quotes\\\": [\\n      2,\\n      `backtick`,\\n      {\\n        avoidEscape: true,\\n      },\\n    ],\\n    \\\"no-console\\\": [`warn`, { allow: [`warn`] }],\\n    \\\"spaced-comment\\\": [2, `always`, { exceptions: [`-`, `+`], markers: [`/`] }],\\n    \\\"no-use-before-define\\\": 0,\\n    \\\"no-plusplus\\\": 0,\\n    \\\"no-continue\\\": 0,\\n    \\\"linebreak-style\\\": 0,\\n    import: 0,\\n    camelcase: 1,\\n    \\\"import/no-unresolved\\\": 0,\\n    \\\"func-names\\\": 0,\\n    \\\"import/no-extraneous-dependencies\\\": 0,\\n    \\\"import/prefer-default-export\\\": 0,\\n    \\\"import/no-cycle\\\": 0,\\n    \\\"space-before-function-paren\\\": 0,\\n    \\\"import/extensions\\\": 0,\\n    \\\"import/no-anonymous-default-export\\\": 2,\\n    \\\"react/jsx-one-expression-per-line\\\": 0,\\n    \\\"react/jsx-filename-extension\\\": [\\n      1,\\n      {\\n        extensions: [`.js`, `.jsx`, `.tsx`],\\n      },\\n    ],\\n    \\\"react-hooks/rules-of-hooks\\\": `error`,\\n    \\\"react-hooks/exhaustive-deps\\\": `warn`,\\n    indent: [`error`, 2, { SwitchCase: 1 }],\\n    \\\"jsx-a11y/href-no-hash\\\": `off`,\\n    \\\"jsx-a11y/anchor-is-valid\\\": [\\n      `warn`,\\n      {\\n        aspects: [`invalidHref`],\\n      },\\n    ],\\n    \\\"prettier/prettier\\\": [\\n      `error`,\\n      {\\n        trailingComma: `es5`,\\n        semi: false,\\n        singleQuote: false,\\n        printWidth: 120,\\n      },\\n    ],\\n  },\\n};\\n\")), mdx(\"p\", null, \"Depending on how you set up your code editor you\\u2019ll already have ESLint working in your project. If you want to run it in the terminal (or in CI) you can add two npm scripts:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\",\n    \"metastring\": \"title=package.json\",\n    \"title\": \"package.json\"\n  }, \"{\\n  \\\"scripts\\\": {\\n    \\\"lint\\\": \\\"eslint . --ignore-path .gitignore --ext .ts,.tsx,.js\\\",\\n    \\\"lint:fix\\\": \\\"yarn lint --fix\\\"\\n  }\\n}\\n\")), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"lint\"), \" command will run ESLint on all files (with the ts/tsx/js/jsx file ending) except the ones defined in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \".gitignore\"), \". The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"--fix\"), \" flag tries to automatically fix your errors. When running \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"yarn lint\"), \" you should get some errors from Prettier. Run \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"yarn lint:fix\"), \" to clean that up!\"), mdx(\"h2\", {\n    \"id\": \"cypress\"\n  }, \"Cypress\"), mdx(\"p\", null, \"The popular End to End testing framework (at \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.cypress.io\"\n  }, \"cypress.io\"), \") is a great tool to test React applications in real-world scenarios compared to unit or integration testing approaches. For Gatsby Themes or any other package that mainly gets used as a template I personally care more about that everything works correctly in the complete set up to ensure that the theme itself isn\\u2019t broken. You can also check components like a dark mode toggle with Cypress, too!\\nAnd that is exactly what you\\u2019ll set up now: A Cypress test suite to run tests against the example site.\"), mdx(\"p\", null, \"First, you need to install the necessary packages. Besides the obvious one \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"cypress\"), \", you\\u2019ll also install \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://testing-library.com/docs/cypress-testing-library/intro/\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"@testing-library/cypress\")), \". Both extend the commands of Cypress, the former improves the process of selecting elements, the latter provides a useful helper function.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"yarn add -D -W @testing-library/cypress cross-env cypress start-server-and-test\\n\")), mdx(\"p\", null, \"The package \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"start-server-and-test\"), \" enables you to first run the development server of Gatsby (or build command) and then the fitting Cypress command. It\\u2019s a really handy little tool! Both \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"@testing-library/cypress\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"cypress\"), \" ship with their own TypeScript typings. That is important to know when writing the Cypress tests in TypeScript.\"), mdx(\"p\", null, \"Once again you need to add some scripts to your root \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"package.json\"), \":\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\",\n    \"metastring\": \"title=package.json\",\n    \"title\": \"package.json\"\n  }, \"{\\n  \\\"scripts\\\": {\\n    \\\"cy:open\\\": \\\"cypress open\\\",\\n    \\\"cy:run\\\": \\\"cross-env CYPRESS_baseUrl=http://localhost:9000 cypress run\\\"\\n  }\\n}\\n\")), mdx(\"p\", null, \"Run \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"yarn cy:open\"), \" to initialize Cypress. It will automatically add files to your repository, like a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"cypress.json\"), \" or the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"cypress\"), \" folder. Quit the app before continuing this tutorial.\"), mdx(Alert, {\n    status: \"info\",\n    title: \"Note\",\n    mdxType: \"Alert\"\n  }, \"At the time of writing this guide WSL (Linux subsystem for Windows) can't open the Cypress electron app when running `cypress open`. You'll need to download the executable and run it yourself.\"), mdx(\"p\", null, \"Delete the contents of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"cypress/integration\"), \" (it contains example data) and rename it to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"e2e\"), \". Edit the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"cypress.json\"), \" file:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\",\n    \"metastring\": \"title=cypress.json\",\n    \"title\": \"cypress.json\"\n  }, \"{\\n  \\\"baseUrl\\\": \\\"http://localhost:8000\\\",\\n  \\\"integrationFolder\\\": \\\"cypress/e2e/build\\\",\\n  \\\"viewportHeight\\\": 900,\\n  \\\"viewportWidth\\\": 1440\\n}\\n\")), mdx(\"p\", null, \"As TypeScript will compile the tests and output it to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"cypress/e2e/build\"), \" you have to tell Cypress to look into that folder.\"), mdx(\"p\", null, \"Now configure the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"cypress/support\"), \" folder. First, add the the custom commands from testing-library, secondly add an import for a new file you\\u2019ll create later. Lastly, create a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \".d.ts\"), \" file to add types for your custom command.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\",\n    \"metastring\": \"title=cypress/support/index.js\",\n    \"title\": \"cypress/support/index.js\"\n  }, \"import \\\"@testing-library/cypress/add-commands\\\";\\nimport \\\"./commands\\\";\\n\")), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"assertRoute\"), \" command let\\u2019s you check the current URL.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\",\n    \"metastring\": \"title=cypress/support/commands.js\",\n    \"title\": \"cypress/support/commands.js\"\n  }, \"Cypress.Commands.add(`assertRoute`, (route) => {\\n  cy.url().should(`equal`, `${window.location.origin}${route}`);\\n});\\n\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-ts\",\n    \"metastring\": \"title=cypress/support/index.d.ts\",\n    \"title\": \"cypress/support/index.d.ts\"\n  }, \"/// <reference types=\\\"cypress\\\" />\\n\\ndeclare namespace Cypress {\\n  interface Chainable<Subject> {\\n    /**\\n     * Assert the current URL\\n     * @param route\\n     * @example cy.assertRoute('/page-2')\\n     */\\n    assertRoute(route: string): Chainable<any>;\\n  }\\n}\\n\")), mdx(\"h3\", {\n    \"id\": \"using-cypress-with-typescript\"\n  }, \"Using Cypress with TypeScript\"), mdx(\"p\", null, \"After the basic setup is done you now can proceed to the final steps before writing tests! Keep it up :)\"), mdx(\"p\", null, \"Create a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"tsconfig.json\"), \" file inside the cypress directory:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\",\n    \"metastring\": \"title=cypress/tsconfig.json\",\n    \"title\": \"cypress/tsconfig.json\"\n  }, \"{\\n  \\\"compilerOptions\\\": {\\n    \\\"baseUrl\\\": \\\"../node_modules\\\",\\n    \\\"outDir\\\": \\\"e2e/build\\\",\\n    \\\"module\\\": \\\"commonjs\\\",\\n    \\\"removeComments\\\": true,\\n    \\\"strict\\\": true,\\n    \\\"sourceMap\\\": false,\\n    \\\"skipLibCheck\\\": true,\\n    \\\"target\\\": \\\"es5\\\",\\n    \\\"lib\\\": [\\\"es2015\\\", \\\"es2017\\\", \\\"dom\\\"],\\n    \\\"types\\\": [\\\"cypress\\\", \\\"@testing-library/cypress\\\"]\\n  },\\n  \\\"include\\\": [\\\"**/*.ts\\\", \\\"support/*.ts\\\"]\\n}\\n\")), mdx(\"p\", null, \"When later running the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"tsc\"), \" scripts this tsconfig will be used, not the one in the root of the repository.\"), mdx(\"p\", null, \"To see if everything works you can add a smoke test (a file to test if bare minimum works, e.g. the site index loads):\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-ts\",\n    \"metastring\": \"title=cypress/e2e/smoke.ts\",\n    \"title\": \"cypress/e2e/smoke.ts\"\n  }, \"/// <reference types=\\\"../support/index\\\" />\\n/// <reference types=\\\"cypress\\\" />\\n/// <reference types=\\\"@testing-library/cypress\\\" />\\n\\ndescribe(`app`, () => {\\n  it(`should work`, () => {\\n    cy.visit(`/`).assertRoute(`/`);\\n  });\\n});\\n\")), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"///\"), \" means that this file should reference the TypeScript typings from these places/packages. Also: Try to hover over the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"assertRoute\"), \" function. Your IDE should display the typings & description. That\\u2019s what you added in the previous step. Isn\\u2019t that cool?\"), mdx(\"p\", null, \"Add the package \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"concurrently\"), \" to run multiple commands at the same time.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"yarn add -D -W concurrently\\n\")), mdx(\"p\", null, \"To complete this portion of the guide you\\u2019ll need to add some npm scripts again to run the test suite now. The goal is to use one command to start the TypeScript compiler, the Gatsby development server of the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"example\"), \" and Cypress.\"), mdx(\"p\", null, \"Add the following scripts to your root \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"package.json\"), \".\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\",\n    \"metastring\": \"title=package.json\",\n    \"title\": \"package.json\"\n  }, \"{\\n  \\\"scripts\\\": {\\n    \\\"tsc:compile\\\": \\\"tsc --project cypress/tsconfig.json\\\",\\n    \\\"tsc:compile:watch\\\": \\\"tsc --watch --project cypress/tsconfig.json\\\"\\n  }\\n}\\n\")), mdx(\"p\", null, \"TypeScript should use the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"cypress/tsconfig.json\"), \" which in turn tells it to compile the files inside \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"cypress/e2e\"), \". The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"--watch\"), \" flag enables automatic re-compilation when saving a file.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\",\n    \"metastring\": \"title=package.json\",\n    \"title\": \"package.json\"\n  }, \"{\\n  \\\"scripts\\\": {\\n    \\\"example:dev\\\": \\\"yarn workspace example develop\\\"\\n  }\\n}\\n\")), mdx(\"p\", null, \"Run the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"develop\"), \" npm script inside \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"example/package.json\"), \" to run the example Gatsby site.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\",\n    \"metastring\": \"title=package.json\",\n    \"title\": \"package.json\"\n  }, \"{\\n  \\\"scripts\\\": {\\n    \\\"ssat:example:dev\\\": \\\"start-server-and-test example:dev http://localhost:8000 cy:open\\\"\\n  }\\n}\\n\")), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"start-server-and-test\"), \" expects the server script, then the URL it should listen to and finally the test script itself.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\",\n    \"metastring\": \"title=package.json\",\n    \"title\": \"package.json\"\n  }, \"{\\n  \\\"scripts\\\": {\\n    \\\"e2e:dev\\\": \\\"concurrently --kill-others 'yarn tsc:compile:watch' 'yarn ssat:example:dev'\\\"\\n  }\\n}\\n\")), mdx(\"p\", null, \"Use \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"concurrently\"), \" to both run the TypeScript compiler (watching your test files) and Cypress at the same time.\"), mdx(\"p\", null, \"Your scripts section should have these new entries now after this section:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\",\n    \"metastring\": \"title=package.json\",\n    \"title\": \"package.json\"\n  }, \"{\\n  \\\"scripts\\\": {\\n    \\\"tsc:compile\\\": \\\"tsc --project cypress/tsconfig.json\\\",\\n    \\\"tsc:compile:watch\\\": \\\"tsc --watch --project cypress/tsconfig.json\\\",\\n    \\\"example:dev\\\": \\\"yarn workspace example develop\\\",\\n    \\\"ssat:example:dev\\\": \\\"start-server-and-test example:dev http://localhost:8000 cy:open\\\",\\n    \\\"e2e:dev\\\": \\\"concurrently --kill-others 'yarn tsc:compile:watch' 'yarn ssat:example:dev'\\\"\\n  }\\n}\\n\")), mdx(\"h2\", {\n    \"id\": \"write-tests\"\n  }, \"Write tests!\"), mdx(\"p\", null, \"Finally you\\u2019re able to write tests! Let\\u2019s do that. Create a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"home.ts\"), \" inside the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"e2e\"), \" folder with the following content:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-ts\",\n    \"metastring\": \"title=cypress/e2e/home.ts\",\n    \"title\": \"cypress/e2e/home.ts\"\n  }, \"/// <reference types=\\\"../support/index\\\" />\\n/// <reference types=\\\"cypress\\\" />\\n/// <reference types=\\\"@types/testing-library__cypress\\\" />\\n\\ndescribe(`example`, () => {\\n  it(`contains keyword on homepage`, () => {\\n    cy.visit(`/`).getByText(/Homepage in a user's site/i);\\n  });\\n});\\n\")), mdx(\"p\", null, \"Run \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"yarn e2e:dev\"), \", click on \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"home.js\"), \" in the Cypress electron app and hopefully see the test working \\uD83C\\uDF89\"), mdx(\"h2\", {\n    \"id\": \"where-to-go-from-here\"\n  }, \"Where to go from here\"), mdx(\"p\", null, \"Yeah, you finished this guide \\uD83D\\uDC4D\\uD83C\\uDFFBThanks for following through \\u2013 I want to give you some ideas on what to do next or how you can adapt this guide for other usecases:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Run the linting and tests on a CI provider (e.g. CircleCI) to have more confidence into your PRs\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Modify the npm scripts to not only test against \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"gatsby develop\"), \" but also \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"gatsby build\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Modify the ESLint config to your liking as it\\u2019s certainly opinionated to my preferred code style\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Add Cypress tests testing the theme options\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Add husky + lint-staged to run the linter before commiting your files\")), mdx(\"p\", null, \"You can see an implementation of this pattern in my themes repository: \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/LekoArts/gatsby-themes\"\n  }, \"https://github.com/LekoArts/gatsby-themes\")));\n}\n;\nMDXContent.isMDXComponent = true;","seoLastUpdated":"2021-05-08T00:00:00.000Z","lastUpdated":"May 08, 2021","seoDate":"2019-08-05T00:00:00.000Z","yearDate":"2019","date":"Aug 05, 2019","subtitle":"A robust solution for multi-package repositories","timeToRead":5,"image":"/og-images/setting-up-yarn-workspace.png?v=1","category":{"name":"JavaScript","slug":"/javascript"},"parent":{"parent":{"relativePath":"2019-08-05--setting-up-a-yarn-workspace-with-type-script-es-lint-and-cypress/index.mdx"}}}},"pageContext":{"slug":"/javascript/setting-up-a-yarn-workspace-with-typescript-eslint-and-cypress"}},"staticQueryHashes":["3050858678","4184542181","492144057","712324210"]}